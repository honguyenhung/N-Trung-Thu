<!doctype html>
<html lang="vi">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>T·∫∑ng B·∫°ng üíñ</title>

  <link rel="icon" type="image/png" href="./myicon.png">
  <link href="https://fonts.googleapis.com/css2?family=Mali:wght@500;700&display=swap" rel="stylesheet">

  <style>
    html, body {
      height: 100%;
      margin: 0;
      font-family: "Mali", cursive;
      background: #060614;
      overflow: hidden;
    }

    .stage { position: relative; min-height: 100vh; overflow: hidden; }
    canvas#starfield { display:block; width:100%; height:100%; }

    .moon {
      position: absolute; top: 60px; right: 100px;
      width: 160px; height: 160px; border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #fff 0%, #f8f8f8 70%, #e0e0e0 100%);
      box-shadow: 0 0 60px rgba(255,255,220,.8); z-index: 10;
    }
    @media (max-width:600px){ .moon{top:40px; right:14px; width:70px; height:70px;} }

    /* ƒê√®n l·ªìng */
    #lantern-container{
      position: fixed; inset:0;
      pointer-events: none; overflow: hidden; z-index: 9;
    }
    .lantern{ position:absolute; width:40px; user-select:none; pointer-events:auto; }
    @keyframes swing{ 0%{transform:rotate(-5deg)} 50%{transform:rotate(5deg)} 100%{transform:rotate(-5deg)} }
    .swing{ animation: swing 2s ease-in-out infinite; }

    /* Popup l·ªùi ch√∫c */
    #wish-popup{
      position: fixed; top: 55%; left: 50%;
      transform: translate(-50%,-50%);
      color:#ffb347;
      padding: 25px 35px;
      font-size:1.8rem; font-weight:700; display:none;
      text-align:center;
      text-shadow: 0 0 20px #ffd180, 0 0 40px #ff8a50;
      z-index:9999;
    }

    .show{ display:block; animation: slideIn .8s ease forwards; }
    .hide{ animation: slideOut .8s ease forwards; }

    @keyframes slideIn{0%{opacity:0; transform:translate(-50%,-30px);}100%{opacity:1; transform:translate(-50%,-50%);}}
    @keyframes slideOut{0%{opacity:1; transform:translate(-50%,-50%);}100%{opacity:0; transform:translate(-50%,-70px);}}

    /* Hai d√≤ng k·∫øt */
    #goodnight, #check-msg {
      position: fixed;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 2rem;
      color: #ffb347;
      text-shadow: 0 0 20px #ffd180, 0 0 40px #ff8a50;
      opacity: 0;
      font-weight: 700;
      transition: opacity 1.2s ease;
      animation: floaty 3s ease-in-out infinite alternate;
      z-index: 9999;
    }
    #goodnight { top: 60%; }
    #check-msg { top: 68%; }

    @keyframes floaty {
      0% { transform: translate(-50%, -52%); }
      100% { transform: translate(-50%, -48%); }
    }
  </style>
</head>

<body>
  <div class="stage">
    <canvas id="starfield"></canvas>
    <div class="moon"></div>

    <!-- ƒê√®n l·ªìng -->
    <div id="lantern-container"></div>

    <!-- Popup l·ªùi ch√∫c -->
    <div id="wish-popup"></div>

    <!-- L·ªùi ch√∫c k·∫øt -->
    <div id="goodnight">üí§ Ch√∫c b·∫°n y√™u ng·ªß ngon nhaaa üíñ</div>
    <div id="check-msg">üí¨ B·∫°n ki·ªÉm tra t√†i kho·∫£n ƒëi =)))</div>

    <audio id="bg-music" loop>
      <source src="a.mp3" type="audio/mp3">
    </audio>
  </div>

  <script>
    // ===== N·ªÅn sao =====
    const canvas = document.getElementById("starfield");
    const ctx = canvas.getContext("2d");
    let w,h,stars=[];
    function resizeCanvas(){
      w = canvas.width = innerWidth;
      h = canvas.height = innerHeight;
      stars = [];
      for(let i=0;i<(w*h)/2200;i++){
        stars.push({x:Math.random()*w,y:Math.random()*h,r:Math.random()*1+0.2,a:Math.random(),t:Math.random()*0.02+0.002});
      }
    }
    function drawStars(){
      ctx.clearRect(0,0,w,h);
      for(const s of stars){
        s.a += (Math.random()>0.5?1:-1)*s.t;
        ctx.globalAlpha = Math.max(.05,Math.min(1,s.a));
        ctx.fillStyle="#fff"; ctx.beginPath(); ctx.arc(s.x,s.y,s.r,0,Math.PI*2); ctx.fill();
      }
      ctx.globalAlpha = 1;
      requestAnimationFrame(drawStars);
    }
    resizeCanvas(); window.addEventListener("resize",resizeCanvas); drawStars();

    // ===== ƒê√®n l·ªìng bay =====
    const lanternContainer = document.getElementById("lantern-container");
    function createLantern(){
      const lantern = document.createElement("img");
      lantern.src = "./den.png"; // h√¨nh ƒë√®n l·ªìng
      lantern.className = "lantern swing";
      const layer = Math.floor(Math.random()*3)+1;
      let size=40, duration=10000, opacity=.8;
      if(layer===1){ size=20+Math.random()*20; duration=14000+Math.random()*5000; opacity=.5; }
      else if(layer===2){ size=30+Math.random()*30; duration=12000+Math.random()*4000; opacity=.7; }
      else { size=40+Math.random()*40; duration=10000+Math.random()*3000; opacity=.95; }
      lantern.style.width = size+"px";
      lantern.style.left = Math.random()*90 + "vw";
      lantern.style.bottom = "0px";
      lantern.style.opacity = opacity;
      lanternContainer.appendChild(lantern);
      const drift = Math.random()*140 - 70;
      const up = 120 + Math.random()*40;
      lantern.animate(
        [{transform:"translate(0,0)", opacity:opacity},{transform:`translate(${drift}px, -${up}vh)`, opacity:0}],
        {duration, easing:"linear", fill:"forwards"}
      );
      setTimeout(()=>lantern.remove(), duration);
    }
    setInterval(createLantern, 500);

    // ===== Nh·∫°c n·ªÅn =====
    const bg = document.getElementById("bg-music");
    let musicStarted=false;
    document.addEventListener("pointerdown", function startMusicOnce(){
      if(!musicStarted && bg){
        bg.volume=0;
        bg.play().then(()=>{
          let v=0; const fade=setInterval(()=>{ v+=.05; if(v>=.9){v=.9; clearInterval(fade);} bg.volume=v; },120);
          musicStarted=true;
        }).catch(()=>{});
      }
      document.removeEventListener("pointerdown", startMusicOnce);
    });

    // ===== L·ªùi ch√∫c ch√≠nh =====
    const wishes = [
      "üåï Ch√∫c Nhi c√≥ Trung Thu th·∫≠t b√¨nh y√™n v√† nh·∫π l√≤ng nha.",
      "üèÆ Mong gia ƒë√¨nh b·∫°n lu√¥n ·∫•m √°p, sum v·∫ßy v√† h·∫°nh ph√∫c.",
      "üç∞ D√π h√¥m nay c√≥ bu·ªìn, mong √°nh trƒÉng mang ƒë·∫øn cho b·∫°n s·ª± d·ªãu d√†ng v√† an y√™n.",
      "‚ú® Ch√∫c b·∫°n s·ªõm m·ªâm c∆∞·ªùi l·∫°i v√† c·∫£m nh·∫≠n ƒë∆∞·ª£c nhi·ªÅu y√™u th∆∞∆°ng h∆°n nha.",
      "Y√™u B·∫°nggg üíñ"
    ];
    const popup = document.getElementById("wish-popup");
    const goodnight = document.getElementById("goodnight");
    const checkMsg = document.getElementById("check-msg");
    let idx = 0, timer = null;

    function showNextWish(){
      if(idx >= wishes.length){
        popup.classList.remove("show");
        popup.classList.add("hide");
        popup.addEventListener("animationend", ()=>{
          popup.style.display="none";
          setTimeout(()=>{
            goodnight.style.opacity = "1";
            // üí¨ xu·∫•t hi·ªán 2 gi√¢y sau khi goodnight hi·ªán
            setTimeout(()=>{
              checkMsg.style.opacity = "1";
            }, 2000);
          }, 3000);
        }, {once:true});
        clearInterval(timer);
        return;
      }
      popup.classList.remove("hide");
      if(popup.textContent){
        popup.classList.add("hide");
        popup.addEventListener("animationend", function onOut(){
          popup.removeEventListener("animationend", onOut);
          popup.textContent = wishes[idx++];
          popup.classList.remove("hide");
          popup.classList.add("show");
        }, {once:true});
      }else{
        popup.style.display="block";
        popup.textContent = wishes[idx++];
        popup.classList.add("show");
      }
    }

    setTimeout(()=>{
      showNextWish();
      timer = setInterval(showNextWish, 4000);
    }, 2000);
  </script>
</body>
</html>
